---
title: JavaScript SDK
description: "SDK JavaScript/TypeScript pour SahelPay"
---

# JavaScript SDK

Le SDK JavaScript officiel pour intégrer SahelPay dans vos applications Node.js, TypeScript ou Deno.

## Installation

```bash
npm install @sahelpay/sdk
# ou
yarn add @sahelpay/sdk
```

<Note>
  En attendant la publication sur npm, clonez le repo GitHub :
  ```bash
  git clone https://github.com/dione24/sahelpay-sdks.git
  ```
</Note>

## Configuration

```typescript
import SahelPay from '@sahelpay/sdk';

const sahelpay = new SahelPay({
  secretKey: process.env.SAHELPAY_SECRET_KEY!,
  environment: 'production' // ou 'sandbox'
});
```

## Créer un paiement

```typescript
const payment = await sahelpay.payments.create({
  amount: 5000,
  currency: 'XOF',
  payment_method: 'ORANGE_MONEY', // ORANGE_MONEY, WAVE, MOOV, CARD
  customer_phone: '+22370123456',
  return_url: 'https://votre-site.com/checkout/return',
  description: 'Commande #123',
});

// Rediriger le client vers Orange Money
window.location.href = payment.redirect_url;
```

## Méthodes de paiement disponibles

| Méthode | Description | Pays |
|---------|-------------|------|
| `ORANGE_MONEY` | Orange Money Direct | Mali |
| `WAVE` | Wave (via PayDunya) | Mali, Sénégal, CI |
| `MOOV` | Moov Money (via PayDunya) | Mali |
| `CARD` | Carte bancaire (via PayDunya) | Tous |

## Vérifier le statut

```typescript
const status = await sahelpay.getPaymentStatus('txn_abc123');

console.log(status.status); // 'PENDING' | 'SUCCESS' | 'FAILED' | 'EXPIRED'
console.log(status.amount);
console.log(status.providerRef);
```

## Vérifier un webhook

```typescript
// Dans votre handler webhook
export async function POST(request: Request) {
  const rawBody = await request.text();
  const signature = request.headers.get('x-sahelpay-signature');

  const result = sahelpay.verifyWebhook(rawBody, signature);

  if (!result.valid) {
    return Response.json({ error: result.error }, { status: 401 });
  }

  const { event, data } = result.payload!;

  if (event === 'payment.success') {
    // Mettre à jour la commande
  }

  return Response.json({ received: true });
}
```

## Types TypeScript

```typescript
import type {
  PaymentResult,
  PaymentStatus,
  WebhookPayload,
  WebhookVerificationResult,
} from '@sahelpay/sdk/merchant';
```

## Gestion des erreurs

```typescript
import { SahelPayError } from '@sahelpay/sdk/merchant';

try {
  const payment = await sahelpay.createPayment({ ... });
} catch (error) {
  if (error instanceof SahelPayError) {
    console.log(error.code);    // 'INVALID_AMOUNT'
    console.log(error.message); // 'Montant minimum: 100 FCFA'
  }
}
```
